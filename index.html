
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì¸í„°ë™í‹°ë¸Œ ê¸°íƒ€ ì¤„ íŒŒë™ + ì†Œë¦¬</title>
  <style>
    body {
      background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      font-family: 'Arial', sans-serif;
      color: white;
      overflow: hidden;
    }
    .container {
      text-align: center;
      background: rgba(0, 0, 0, 0.7);
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      max-width: 900px;
      width: 90%;
    }
    canvas {
      background: #121212;
      display: block;
      margin: 20px auto;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
    }
    h1 {
      color: #ffcc00;
      margin-bottom: 10px;
      font-size: 2.5em;
      text-shadow: 0 0 10px rgba(255, 204, 0, 0.5);
    }
    p {
      color: #ddd;
      max-width: 600px;
      margin: 0 auto 20px;
      line-height: 1.6;
    }
    .controls {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    button {
      background: #ffcc00;
      color: #1a1a1a;
      border: none;
      padding: 12px 25px;
      border-radius: 50px;
      font-size: 1.1em;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }
    button:hover {
      background: #ffdd33;
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
    }
    .info-panel {
      background: rgba(0, 0, 0, 0.6);
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
      text-align: left;
    }
    .string-info {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      margin-top: 10px;
    }
    .string-item {
      background: rgba(255, 204, 0, 0.1);
      padding: 8px 15px;
      border-radius: 20px;
      margin: 5px;
      font-size: 0.9em;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¸ ì¸í„°ë™í‹°ë¸Œ ê°€ìƒ ê¸°íƒ€</h1>
    <p>ë§ˆìš°ìŠ¤ë¥¼ ê¸°íƒ€ ì¤„ ìœ„ë¡œ ê°€ì ¸ê°€ë©´ íŒŒë™ì´ ë°œìƒí•˜ê³  í•´ë‹¹ ìŒê³„ì˜ ì†Œë¦¬ê°€ ë‚©ë‹ˆë‹¤. ê° ì¤„ì€ ì‹¤ì œ ê¸°íƒ€ ìŒê³„ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.</p>
    
    <div class="controls">
      <button id="muteBtn">ğŸ”‡ ìŒì†Œê±°</button>
      <button id="demoBtn">ğŸµ ë°ëª¨ ì¬ìƒ</button>
    </div>
    
    <canvas id="guitar" width="800" height="400"></canvas>
    
    <div class="info-panel">
      <h3>ê¸°íƒ€ ì¤„ ì •ë³´</h3>
      <div class="string-info">
        <div class="string-item">1ë²ˆ ì¤„ (E2 - 82.41Hz)</div>
        <div class="string-item">2ë²ˆ ì¤„ (A2 - 110.00Hz)</div>
        <div class="string-item">3ë²ˆ ì¤„ (D3 - 146.83Hz)</div>
        <div class="string-item">4ë²ˆ ì¤„ (G3 - 196.00Hz)</div>
        <div class="string-item">5ë²ˆ ì¤„ (B3 - 246.94Hz)</div>
        <div class="string-item">6ë²ˆ ì¤„ (E4 - 329.63Hz)</div>
      </div>
    </div>
  </div>
  
  <script>
    // ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    const audioContext = new AudioContext();
    let isMuted = false;
    
    const canvas = document.getElementById('guitar');
    const ctx = canvas.getContext('2d');
    const width = canvas.width;
    const height = canvas.height;

    // ê¸°íƒ€ ì¤„ ì„¤ì •
    const stringCount = 6;
    const points = 200;
    const threshold = 15;
    const stringSpacing = height / (stringCount + 1);
    const stringColors = ['#b8860b', '#c0c0c0', '#c0c0c0', '#c0c0c0', '#c0c0c0', '#b8860b'];
    const stringWidths = [6, 5, 4, 3, 2.5, 2];
    
    // ê¸°íƒ€ ìŒê³„ ì£¼íŒŒìˆ˜ (E2, A2, D3, G3, B3, E4)
    const frequencies = [82.41, 110.00, 146.83, 196.00, 246.94, 329.63];
    
    // ê° ì¤„ì˜ íŒŒë™ ì •ë³´ ê´€ë¦¬
    const strings = [];
    for (let i = 0; i < stringCount; i++) {
      strings.push({
        y: stringSpacing * (i + 1),
        waves: [],
        isOnLine: false,
        wasOnLine: false,
        frequency: frequencies[i]
      });
    }

    let mouseX = width / 2;
    let mouseY = height / 2;
    let time = 0;

    // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ ì²˜ë¦¬
    canvas.addEventListener('mousemove', (e) => {
      const rect = canvas.getBoundingClientRect();
      mouseX = e.clientX - rect.left;
      mouseY = e.clientY - rect.top;

      strings.forEach((string, idx) => {
        string.isOnLine = (
          Math.abs(mouseY - string.y) < (stringWidths[idx] / 2 + threshold) &&
          mouseX >= 0 && mouseX <= width
        );
      });
    });

    canvas.addEventListener('mouseleave', () => {
      strings.forEach(string => {
        string.isOnLine = false;
        string.wasOnLine = false;
      });
    });

    // ìŒì†Œê±° ë²„íŠ¼
    document.getElementById('muteBtn').addEventListener('click', () => {
      isMuted = !isMuted;
      document.getElementById('muteBtn').textContent = isMuted ? "ğŸ”ˆ ìŒì†Œê±° í•´ì œ" : "ğŸ”‡ ìŒì†Œê±°";
    });

    // ë°ëª¨ ì¬ìƒ ë²„íŠ¼
    document.getElementById('demoBtn').addEventListener('click', () => {
      playDemo();
    });

    // ê¸°íƒ€ ì†Œë¦¬ ì¬ìƒ í•¨ìˆ˜
    function playStringSound(stringIdx) {
      if (isMuted || !audioContext) return;
      
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      
      oscillator.type = 'sine';
      oscillator.frequency.setValueAtTime(strings[stringIdx].frequency, audioContext.currentTime);
      
      // ì†Œë¦¬ ê°ì‡  íš¨ê³¼
      gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 1.5);
      
      oscillator.start();
      oscillator.stop(audioContext.currentTime + 1.5);
    }

    // ë°ëª¨ ì¬ìƒ í•¨ìˆ˜
    function playDemo() {
      let delay = 0;
      for (let i = 0; i < stringCount; i++) {
        setTimeout(() => {
          createWave(i);
          playStringSound(i);
        }, delay);
        delay += 300;
      }
    }

    // íŒŒë™ ìƒì„±
    function createWave(stringIdx) {
      strings[stringIdx].waves.push({
        centerX: mouseX,
        amplitude: 18 + 4 * (stringCount - stringIdx),
        decayRate: 0.95,
        startTime: time
      });
      
      // ë§ˆìš°ìŠ¤ê°€ ì¤„ì— ë‹¿ì„ ë•Œ ì†Œë¦¬ ì¬ìƒ
      if (strings[stringIdx].isOnLine && !strings[stringIdx].wasOnLine) {
        playStringSound(stringIdx);
      }
    }

    // íŒŒë™ ì—…ë°ì´íŠ¸
    function updateWaves() {
      strings.forEach(string => {
        for (let i = string.waves.length - 1; i >= 0; i--) {
          string.waves[i].amplitude *= string.waves[i].decayRate;
          if (string.waves[i].amplitude < 0.1) {
            string.waves.splice(i, 1);
          }
        }
      });
    }

    // ê·¸ë¦¬ê¸° í•¨ìˆ˜
    function draw() {
      ctx.clearRect(0, 0, width, height);
      
      // ë°°ê²½ì— ê¸°íƒ€ ëª¨ì–‘ ì¶”ê°€
      drawGuitarBody();
      
      // ì¤„ë³„ íŒŒë™ ìƒì„±
      strings.forEach((string, idx) => {
        if (string.isOnLine && !string.wasOnLine) {
          createWave(idx);
        }
        string.wasOnLine = string.isOnLine;
      });

      updateWaves();

      // ê¸°íƒ€ì¤„ ê·¸ë¦¬ê¸°
      strings.forEach((string, idx) => {
        ctx.beginPath();
        for (let i = 0; i <= points; i++) {
          const x = (i / points) * width;
          let y = string.y;

          for (const wave of string.waves) {
            const dx = x - wave.centerX;
            const distanceFactor = Math.exp(-Math.abs(dx) / 150);
            const timeFactor = time - wave.startTime;
            y += wave.amplitude * distanceFactor * Math.sin((dx / 30) - timeFactor);
          }

          if (i === 0) ctx.moveTo(x, y);
          else ctx.lineTo(x, y);
        }
        ctx.strokeStyle = string.isOnLine ? '#ffcc00' : stringColors[idx];
        ctx.lineWidth = stringWidths[idx];
        ctx.lineCap = 'round';
        ctx.stroke();
      });

      // ê¸°íƒ€ ë¸Œë¦¿ì§€ ê·¸ë¦¬ê¸°
      ctx.fillStyle = '#333';
      ctx.fillRect(0, height/2 - 25, 20, 50);
      ctx.fillRect(width - 20, height/2 - 25, 20, 50);
      
      time += 0.08;
      requestAnimationFrame(draw);
    }

    // ê¸°íƒ€ ëª¸ì²´ ê·¸ë¦¬ê¸°
    function drawGuitarBody() {
      ctx.fillStyle = 'rgba(125, 70, 20, 0.6)';
      ctx.beginPath();
      ctx.ellipse(width/2, height/2, width/2.5, height/1.8, 0, 0, Math.PI * 2);
      ctx.fill();
      
      ctx.fillStyle = 'rgba(100, 50, 10, 0.8)';
      ctx.fillRect(width/2 - 15, 0, 30, height);
    }

    // ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ í™œì„±í™” (ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ì‹œ)
    document.body.addEventListener('click', () => {
      if (audioContext.state === 'suspended') {
        audioContext.resume();
      }
    }, { once: true });

    draw();
  </script>
</body>
</html>
